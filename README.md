<h1 align="left">💳 WHMCS Zarinpal Payment Gateway</h1>

###

<p align="right">ماژول درگاه پرداخت زرین‌پال (Zarinpal) برای WHMCS<br>این ماژول امکان پرداخت امن و سریع از طریق درگاه زرین‌پال را برای کاربران فراهم می‌کند.</p>

###

<h2 align="right">🚀 ویژگی‌ها</h2>

###

<p align="right">- پشتیبانی کامل از نسخه‌های جدید WHMCS<br>- رمزگذاری امن اطلاعات فاکتور (Base64 + Replace Encode)<br>- تأیید تراکنش‌ها از طریق API رسمی زرین‌پال (نسخه v4)<br>- ثبت تراکنش‌ها در لاگ WHMCS<br>- بازگشت خودکار به صفحه فاکتور پس از پرداخت<br>- مدیریت آسان و نصب سریع</p>

###

<h2 align="right">🧩 پیش‌نیازها</h2>

###

<br clear="both">

<p align="right">- نسخه whmcs 7.10 یا بالاتر<br>- فعال بودن افزونه cURL در PHP<br>- حساب کاربری فعال در [Zarinpal.com](https://zarinpal.com)</p>

###

<h2 align="right">⚙️ نصب و راه‌اندازی</h2>

###

<p align="right">1. فایل ماژول را در مسیر زیر آپلود کنید:<br>2. وارد پنل مدیریت WHMCS شوید:<br>3. از بخش All Payment Gateways گزینه vozp را انتخاب کنید.<br>4. اطلاعات زیر را وارد نمایید:<br>مرچند کد : شناسه مرچنت زرین‌پال شما<br>واحد پول : واحد پول (تومان یا ریال) <br>دپارتمان گزارش ارسال خطا : در صورتی که کاربر خطایی در پرداخت داشته باشد با زدن کلید گزارش خطا به این دپارتمان پشتیبانی تیکت ارسال میشود <br><br>5. تغییرات را ذخیره کنید ✅</p>

###

<h2 align="right">🔁 فرآیند پرداخت</h2>

###

<p align="right">در این ماژول، اطلاعات فاکتور (شماره، مبلغ و کاربر) با تابع decodeHash() رمزگشایی می‌شوند.<br>نمونه رمزگذاری داده‌ها:</p>

###

```php
$replace = array(
    '1' => 'Q', '2' => 'W', '3' => 'E', '4' => 'Z',
    '5' => 'N', '6' => 'M', '7' => 'L', '8' => 'Y',
    '9' => 'U', '0' => 'D', ';' => 'V',
);
```
<p align="right">در هنگام بازگشت از زرین‌پال، اطلاعات رمزگشایی شده و بررسی می‌شود.</p>

###

<h2 align="right">🔑 ساخت لینک رمزگذاری‌شده فاکتور</h2>

###

<p align="right">کاربر فاکتور را در WHMCS مشاهده می‌کند.<br>روی گزینه پرداخت با زرین‌پال کلیک می‌کند.<br>اطلاعات فاکتور به صورت رمزگذاری‌شده به درگاه ارسال می‌شود.<br>پس از پرداخت، زرین‌پال نتیجه تراکنش را به اسکریپت callback بازمی‌گرداند.<br>سیستم پرداخت را تأیید کرده و فاکتور را به‌صورت خودکار پرداخت‌شده ثبت می‌کند.</p>

###

<h2 align="right">📄 فایل‌های اصلی</h2>

###

<p align="right">توضیح فایل ها :<br>modules/gateways/vozp.php : فایل اصلی ماژول درگاه پرداخت<br>modules/gateways/callback/vozp.php : بررسی وضعیت تراکنش و ثبت پرداخت</p>

###

<h2 align="right">📦 پاسخ سرور زرین‌پال</h2>

###

<p align="right">در فایل callback، تأیید تراکنش از طریق API زیر انجام می‌شود:</p>
POST https://api.zarinpal.com/pg/v4/payment/verify.json

<br>
<p align="right">پارامترهای ارسال‌شده:</p>
<pre>
{
    "merchant_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "authority": "A00000000000000000000000000123456789",
    "amount": 10000
}
</pre>

<br>
<p align="right">در صورت موفقیت:</p>
```php
{
    "data": {
        "code": 100,
        "ref_id": "1234567890"
    }
}```


###

<h2 align="right">🛡️ نکات امنیتی</h2>

###

<p align="right">اطمینان حاصل کنید که URL بازگشت (callback) فقط از طریق HTTPS در دسترس باشد.<br>هیچ داده‌ای را بدون رمزگذاری ارسال نکنید.<br>از توکن معتبر زرین‌پال استفاده کنید.</p>

###

<h2 align="right">👨‍💻 توسعه‌دهنده</h2>

###

<p align="right">توسعه‌دهنده: وهاب سیدی<br><br>وبسایت: [vahabonline.ir](http://vahabonline.ir)</p>

###

<h2 align="right">📜 مجوز (License)</h2>

###

<p align="right">کد منبع تحت مجوز MIT License منتشر شده است.<br>شما می‌توانید آزادانه آن را ویرایش، توسعه و استفاده نمایید.</p>

###

<h2 align="right">⭐ حمایت کنید</h2>

###

<p align="right">اگر این ماژول برای شما مفید بود، با دادن ⭐ در GitHub از توسعه ادامه‌اش حمایت کنید 💙</p>

###
